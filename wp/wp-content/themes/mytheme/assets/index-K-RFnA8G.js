import{d as S,p as se,r as y,q as ae,g as le,C as ne,o as l,a as r,k as d,w as C,i as e,t as _,F as H,s as U,b as h,j as M,_ as D,D as re,e as k,n as I,c as L,T as ie,E as V,G as ue,H as de,A as ce,I as me,J as _e,K as q,M as T,N as ve,O as pe,Q as fe}from"./index-CR06nOXn.js";import{u as R,C as ge,f as he}from"./CircleLinkItem-23NEEeFC.js";import{u as $e}from"./meta-DxkICGRB.js";import{B as ye}from"./Breadcrumbs-D86JBBn7.js";const Ce={class:"CartItem"},be=["src"],Be={class:"CartItem__content"},Ie={class:"CartItem__name"},ke={key:0,class:"CartItem__categories"},Se={key:0,class:"CartItem__button"},De="https://placehold.jp/24/cccccc/ffffff/200x200.png?text=No Image",Me=S({__name:"CartItem",props:{isNotDeleteButton:{type:Boolean},id:{},name:{},image:{},description:{},num:{},price:{},categories:{},tags:{}},setup(f){const a=se(),g=R(),n=f,i=y([]);return ae(()=>n.categories,async s=>{if(s&&s.length>0)try{i.value=await a.getCategoryByIds(s),console.log("Fetched Categories:",i.value)}catch(p){console.error("Error fetching categories:",p)}else i.value=[]},{immediate:!0}),le(async()=>{if(n.categories&&n.categories.length>0)try{i.value=await a.getCategoryByIds(n.categories),console.log("Fetched Categories on Mounted:",i.value)}catch(s){console.error("Error fetching categories on mounted:",s)}}),(s,p)=>{const t=ne("router-link");return l(),r("div",Ce,[d(t,{class:"CartItem__imageWrap",to:`/detail/${s.id}`,target:"_blank"},{default:C(()=>[e("img",{class:"CartItem__image",src:s.image?s.image:De,alt:""},null,8,be)]),_:1},8,["to"]),e("div",Be,[e("p",Ie,_(s.name),1),i.value.length?(l(),r("ul",ke,[(l(!0),r(H,null,U(i.value,c=>(l(),r("li",{key:c.id},[d(ge,{text:c.name,href:`/category/${c.id}`},null,8,["text","href"])]))),128))])):h("",!0)]),s.isNotDeleteButton?h("",!0):(l(),r("div",Se,[e("button",{class:"CartItem__delete",onClick:p[0]||(p[0]=c=>M(g).deleteItem(s.id))}," ×削除 ")]))])}}}),Ne=D(Me,[["__scopeId","data-v-42953653"]]),Pe={class:"CartItems"},we={key:0,class:"CartItems__items"},Ee={key:1},qe=S({__name:"CartItems",props:{items:{},isNotDeleteButton:{type:Boolean}},setup(f){return(a,g)=>(l(),r("div",Pe,[a.items&&a.items.length?(l(),r("ul",we,[(l(!0),r(H,null,U(a.items,n=>(l(),r("li",{key:n.id,class:"CartItems__item"},[d(Ne,re({ref_for:!0},n,{isNotDeleteButton:a.isNotDeleteButton}),null,16,["isNotDeleteButton"])]))),128))])):(l(),r("div",Ee,"カートには何も入っていません"))]))}}),j=D(qe,[["__scopeId","data-v-5bec7a68"]]),Te=["disabled"],Oe=["src"],xe=S({__name:"Button",props:{text:{},color:{default:"black"},size:{default:"s"},isActive:{type:Boolean},isDisabled:{type:Boolean},icon:{}},setup(f){return(a,g)=>(l(),r("button",{class:I(["Button",[`Button--${a.color}`,`Button--${a.size}`,{"Button--active":a.isActive,"Button--disabled":a.isDisabled}]]),disabled:!!a.isDisabled},[a.icon?(l(),r("img",{key:0,class:"Button__icon",src:a.icon,alt:""},null,8,Oe)):h("",!0),k(" "+_(a.text),1)],10,Te))}}),B=D(xe,[["__scopeId","data-v-859d3529"]]),ze={class:"Modal__inner"},Ae={class:"Modal__header"},Fe={class:"Modal__body"},Ve={class:"Modal__footer"},je=S({__name:"Modal",props:{title:{},size:{default:"l"},isShow:{type:Boolean}},emits:["close"],setup(f,{emit:a}){const g=a,n=()=>{g("close",!1)};return(i,s)=>(l(),L(ie,{name:"fade"},{default:C(()=>[i.isShow?(l(),r("section",{key:0,class:I(["Modal",[`Modal--${i.size}`]])},[e("div",{class:"Modal__overlay",onClick:s[0]||(s[0]=p=>n())}),e("div",ze,[e("header",Ae,[e("h1",null,_(i.title),1),e("button",{class:"Modal__closeButton",onClick:s[1]||(s[1]=p=>n())}," × ")]),e("main",Fe,[V(i.$slots,"body",{},void 0,!0)]),e("footer",Ve,[V(i.$slots,"footer",{},()=>[d(B,{text:"×閉じる",color:"gray",onClick:s[2]||(s[2]=p=>n())})],!0)])])],2)):h("",!0)]),_:3}))}}),O=D(je,[["__scopeId","data-v-50d2e613"]]),v=f=>(me("data-v-faaa416d"),f=f(),_e(),f),He={class:"Page"},Ue=v(()=>e("h1",null,"カート",-1)),Le={class:"Page__wrap"},Re={class:"Page__itemsWrap"},Ze={key:0,class:"Page__order"},Ge=v(()=>e("p",null,"必要な情報をご入力ください。",-1)),Qe={class:"table"},We=v(()=>e("colgroup",null,[e("col",{width:"30%"})],-1)),Je=v(()=>e("th",null,[e("label",{for:"name"},[k("お名前"),e("span",{class:"hissu"},"必須")])],-1)),Ke={key:0,class:"Page__errorText"},Xe=v(()=>e("th",null,[e("label",{for:"email"},[k("メールアドレス"),e("span",{class:"hissu"},"必須")])],-1)),Ye={key:0,class:"Page__errorText"},et=v(()=>e("label",{for:"qustion"},"ご質問等",-1)),tt={key:0,class:"Page__errorText"},ot={class:""},st={class:"Page__modalButtons"},at=v(()=>e("p",null,"よろしければ注文してください。",-1)),lt={class:"table"},nt=v(()=>e("colgroup",null,[e("col",{width:"30%"})],-1)),rt=v(()=>e("th",null,"お名前",-1)),it=v(()=>e("th",null,"メールアドレス",-1)),ut=v(()=>e("th",null,"ご質問等",-1)),dt={class:"Page__modalButtons"},ct=v(()=>e("p",null,[k(" 何らかの理由で注文ができませんでした。"),e("br"),k("恐れ入りますが少し時間をおいてから再度お試しください。 ")],-1)),b=500,mt=S({__name:"index",setup(f){const a=ue();de(),$e("カート","カート");const g=y([{text:"カート"}]),n=R();console.log("cartStore.items",n.items);const i=y(!1),s=()=>{i.value=!0},p=()=>{i.value=!1},t=y({name:"aaaa",email:"aaa@aa.jp",question:""}),c=y(""),Z=()=>{if(c.value="",!t.value.name){c.value="お名前は必須項目です";return}},$=y(""),G=()=>{if($.value="",!t.value.email){$.value="メールアドレスは必須項目です";return}if(!/^[a-zA-Z0-9._%+-]+@[a-zA-Z0-9.-]+\.[a-zA-Z]{2,}$/.test(t.value.email)){$.value="メールアドレスの形式が正しくありません";return}},x=m=>{m==="name"&&(c.value=""),m==="email"&&($.value="")},z=ce(()=>!!(c.value||!t.value.name||$.value||!t.value.email||t.value.question.length>b)),N=y(!1),Q=()=>{if(z.value)return!1;p(),N.value=!0},P=()=>{N.value=!1},w=y(!1),A=()=>{w.value=!0},W=()=>{w.value=!1,location.reload()},J=async()=>{try{P();const m=he(new Date,"yyyyMMddHHmm");let o="";n.items.forEach(oe=>{o+=oe.name+`
`});const u=`注文番号：${m}`,K=`From: ${t.value.email}`,X=`サイトから注文が来ました。

─ご注文内容の確認─────────────────
受付番号：${m}

ご注文商品：
${o}

[ お名前 ] ${t.value.name}
[ メールアドレス ] ${t.value.email}
[ ご質問等 ] 
${t.value.question}

──────────────────────────`,Y=`[${m}]ご注文ありがとうございます`,ee=`From: ${t.value.email}`,te=`${t.value.name} 様
──────────────────────────

ご注文を承りました。
後程ご連絡させていただきますので今しばらくお待ちください。

─ご注文内容の確認─────────────────
受付番号：${m}

ご注文商品：
${o}

[ お名前 ] ${t.value.name}
[ メールアドレス ] ${t.value.email}
[ ご質問等 ] 
${t.value.question}

──────────────────────────`,F={orderItems:n.items,orderNo:m,email:t.value.email,name:t.value.name,question:t.value.question,toOrner:{subject:u,headers:K,body:X},toCustomer:{subject:Y,headers:ee,body:te},csrf_token:a.csrfToken,enviroment:ve};console.log("postData:",F);const E=await pe.post(`${fe}/send.php`,F,{headers:{"Content-Type":"text/plain"}});console.log("response:",E),E.status===200&&E.data.result?location.href="/cart/complete":A()}catch(m){console.error("注文処理中にエラーが発生しました:",m),A()}};return(m,o)=>(l(),r("section",He,[g.value&&g.value.length?(l(),L(ye,{key:0,items:g.value},null,8,["items"])):h("",!0),Ue,e("div",Le,[e("div",Re,[d(j,{items:M(n).items},null,8,["items"])]),M(n).items.length?(l(),r("div",Ze,[e("button",{class:"Page__orderButton",onClick:o[0]||(o[0]=u=>s())}," この内容で注文する ")])):h("",!0)]),d(O,{isShow:i.value,title:"注文",size:"l",onClose:p},{body:C(()=>[Ge,e("table",Qe,[We,e("tbody",null,[e("tr",null,[Je,e("td",null,[q(e("input",{id:"name",class:I({error:c.value}),type:"text","onUpdate:modelValue":o[1]||(o[1]=u=>t.value.name=u),onFocus:o[2]||(o[2]=u=>x("name")),onBlur:o[3]||(o[3]=u=>Z())},null,34),[[T,t.value.name]]),c.value?(l(),r("p",Ke,_(c.value),1)):h("",!0)])]),e("tr",null,[Xe,e("td",null,[q(e("input",{id:"email",class:I({error:$.value}),type:"email","onUpdate:modelValue":o[4]||(o[4]=u=>t.value.email=u),onFocus:o[5]||(o[5]=u=>x("email")),onBlur:o[6]||(o[6]=u=>G())},null,34),[[T,t.value.email]]),$.value?(l(),r("p",Ye,_($.value),1)):h("",!0)])]),e("tr",null,[e("th",null,[et,e("small",null,"※"+_(b)+"文字以内")]),e("td",null,[q(e("textarea",{id:"qustion",class:I(["Page__qustion",{error:t.value.question.length>b}]),"onUpdate:modelValue":o[7]||(o[7]=u=>t.value.question=u)},null,2),[[T,t.value.question]]),t.value.question.length>b?(l(),r("p",tt,_(b)+"文字を超えています ")):h("",!0),e("small",ot,_(t.value.question.length)+"/"+_(b)+"文字",1)])])])])]),footer:C(()=>[e("div",st,[d(B,{class:"Page__modalButton",text:"キャンセル",color:"gray",onClick:o[8]||(o[8]=u=>p())}),d(B,{class:"Page__modalButton",text:"確認",color:"blue",isDisabled:z.value,onClick:o[9]||(o[9]=u=>Q())},null,8,["isDisabled"])])]),_:1},8,["isShow"]),d(O,{isShow:N.value,title:"注文確認",size:"l",onClose:P},{body:C(()=>[at,e("table",lt,[nt,e("tbody",null,[e("tr",null,[rt,e("td",null,_(t.value.name),1)]),e("tr",null,[it,e("td",null,_(t.value.email),1)]),e("tr",null,[ut,e("td",null,[e("pre",null,_(t.value.question),1)])])])]),d(j,{items:M(n).items,isNotDeleteButton:""},null,8,["items"])]),footer:C(()=>[e("div",dt,[d(B,{class:"Page__modalButton",text:"キャンセル",color:"gray",onClick:o[10]||(o[10]=u=>P())}),d(B,{class:"Page__modalButton",text:"注文する",color:"blue",onClick:o[11]||(o[11]=u=>J())})])]),_:1},8,["isShow"]),d(O,{isShow:w.value,title:"注文エラー",size:"l",onClose:W},{body:C(()=>[ct]),_:1},8,["isShow"])]))}}),gt=D(mt,[["__scopeId","data-v-faaa416d"]]);export{gt as default};
